<!-- Contenedor principal del diálogo de edición de usuario -->
<div class="container">
  <h2>Editar Usuario</h2>

  <!-- Formulario reactivo vinculado a 'form' definido en el componente TypeScript -->
  <form [formGroup]="form" (ngSubmit)="save()">

    <!-- Campo de nombre de usuario (obligatorio) -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Usuario</mat-label>
      <input matInput formControlName="usuario" required />
    </mat-form-field>

    <!-- Campo para introducir una nueva contraseña (vacío por defecto) -->
    <!-- Si no se rellena, se mantiene la actual -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Nueva Contraseña</mat-label>
      <input matInput type="password" formControlName="password" />
    </mat-form-field>

    <!-- Campo para editar el nombre público mostrado en la aplicación -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Nombre Público</mat-label>
      <input matInput formControlName="nombre_publico" />
    </mat-form-field>

    <!-- Selector de rol del usuario -->
    <!-- Solo se muestran los roles permitidos según el rol actual (controlado en el ts) -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Rol</mat-label>
      <mat-select formControlName="id_rol" required>
        <mat-option *ngFor="let rol of roles" [value]="rol.id_rol">
          {{ rol.nombre_rol }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Campo de correo electrónico (con validación de formato) -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Email</mat-label>
      <input matInput formControlName="email" type="email" />
    </mat-form-field>

    <!-- Campo para observaciones o notas adicionales del usuario -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Observaciones</mat-label>
      <textarea matInput formControlName="observaciones"></textarea>
    </mat-form-field>

    <!-- Checkbox para indicar si el usuario está habilitado (activo en la app) -->
    <mat-checkbox formControlName="habilitado">
      Habilitado
    </mat-checkbox>

    <!-- Botones de acción: Cancelar o Guardar -->
    <!-- Cancelar cierra el modal sin guardar, Guardar llama al método save() -->
    <mat-dialog-actions align="end">
      <button mat-button type="button" (click)="cancelar()">Cancelar</button>
      <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">Guardar</button>
    </mat-dialog-actions>

  </form>
</div>
